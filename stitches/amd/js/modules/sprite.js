// Copyright 2013, Matthew Cobbs

// Licensed under the MIT license.

define(["jquery","util/util","util/templates"],function(c,d,e){var f={name:"",src:"",padding:0,callback:null},b=function(a){this.settings=c.extend({},f,a);this.$element=null;this.name=d.cleanName(this.settings.name);this.src=this.settings.src;this.padding=parseInt(this.settings.padding,10);this.callback=this.settings.callback;this.placed=this.active=!1;this.init()};b.classname=".stitches-sprite";b.prototype={constructor:b,init:function(){this.load()},load:function(){var a=this;this.image=new Image;
this.image.onload=function(){a.x=0;a.y=0;a.width=a.image.width+2*a.padding;a.height=a.image.height+2*a.padding;a.area=a.width*a.height;a.render();a.proxy();a.bind();a.callback&&a.callback(a)};this.image.src=this.src},render:function(){var a=e.sprite(this);this.$element=c(a);this.$element.data("sprite",this)},proxy:function(){d.proxy(this,"click")},bind:function(){this.$element.on("click",this.click)},reset:function(){this.y=this.x=0;this.placed=!1;this.$element.removeClass("placed")},show:function(){this.$element.css({left:this.x+
"px",top:this.y+"px",padding:this.padding+"px"}).addClass("placed")},click:function(){(this.active=!this.active)?(this.$element.trigger("clear-active",[this]),this.$element.trigger("open-properties",[this])):this.$element.trigger("close-properties");this.$element.toggleClass("active")},configure:function(a){a.padding&&(this.padding=parseInt(a.padding,10),this.width=this.image.width+2*this.padding,this.height=this.image.height+2*this.padding,this.area=this.width*this.height)}};return b});